# 修复文件上传功能问题

## 问题描述

PWA 笔记应用中的上传图片和上传文档功能完全失效，需要进行全面的问题诊断和修复。

## 当前状态

### 已发现的问题
1. **MIME 类型配置错误**
   - 文档上传区域使用了无效的 MIME 类型格式
   - 控制台出现大量 MIME 类型警告

2. **文件上传逻辑错误**
   - uploadFile 函数试图访问原生 File 对象上不存在的 url 和 thumbnail 属性
   - 缺少文件 URL 生成和缩略图处理逻辑

3. **功能完全失效**
   - 用户无法上传任何图片或文档
   - 拖拽和点击上传都不工作

## 技术要求

### 核心功能
1. **图片上传**
   - 支持常见图片格式 (jpg, png, gif, webp)
   - 自动生成缩略图
   - 文件大小限制 5MB

2. **文档上传**
   - 支持 PDF, DOC, DOCX, TXT, XLS, XLSX, CSV
   - 文件大小限制 20MB
   - 正确的 MIME 类型配置

3. **文件处理**
   - 生成临时 URL 用于预览
   - 图片缩略图生成
   - 错误处理和用户反馈

### 技术栈
- React + TypeScript
- react-dropzone 用于文件拖拽
- Canvas API 用于缩略图生成
- 现有的 sync-provider 架构

## 验收标准

1. **功能性**
   - 图片上传正常工作
   - 文档上传正常工作
   - 文件在界面中正确显示

2. **用户体验**
   - 拖拽上传流畅
   - 上传进度显示
   - 错误提示清晰

3. **技术质量**
   - 无控制台错误
   - 正确的 MIME 类型配置
   - 内存泄漏防护

## 优先级
高优先级 - 核心功能缺失，影响用户基本使用
